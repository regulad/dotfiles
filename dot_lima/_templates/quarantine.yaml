base:
  - template:ubuntu-lts
cpus: 2
memory: "4GiB"
disk: "20GiB"
user:
  name: "regulad"
  uid: 1000
  home: "/home/regulad"
mounts:
  - location: "~/repositories"
    mountPoint: "/home/regulad/repositories"
    writable: true
provision:
  - mode: user
    script: |
      #!/usr/bin/env bash
      set -eu

      touch /tmp/.did-provision

      export DEBIANFRONTEND=noninteractive
      export NONINTERACTIVE=1

      GITHUB_USERNAME=regulad

      /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
      eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

      # bootstrap
      brew install \
        chezmoi \
        bitwarden-cli

      chezmoi init $GITHUB_USERNAME
